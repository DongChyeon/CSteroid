---
date: 2025-10-31
user: DongChyeon
topic: Thrashing 이란?
---

### 1. Thrashing 이란?

Thrashing(스래싱)은 컴퓨터 시스템이 페이지 부재(Page Fault)를 처리하느라 대부분의 시간을 소모하는 상태를 말한다.
즉, CPU가 실제로 프로그램 명령을 실행하지 못하고, 계속 디스크와 메모리 사이를 오가며 페이지 교체만 수행하는 상황이다.

프로그램을 많이 실행시키면 처음에는 정상적으로 메모리에 적재되지만, 메모리가 가득차면 새로운 페이지를 올릴 때마다 기존 페이지를 내보내야 한다.
이 과정에서 필요한 페이지가 계속 교체되어 디스크 접근이 폭증하고, 결국 CPU는 대부분의 시간을 I/O 대기로 보내며 시스템 전체 성능이 급격히 저하된다.

### 2. 페이징과 페이지 폴트

Thrashing을 이해하려면 페이징과 페이지 폴트 개념을 알아야 한다.

#### 페이징(Paging)

가상 메모리 (Virtual Memory) 시스템을 사용하면 프로세스는 연속된 메모리 공간을 가진 것처럼 보이지만, 실제로는 물리 메모리가 아닌 디스크에 저장된 페이지 단위로 관리된다.

- 가상 주소 공간은 일정 크기의 블록(페이지, 보통 4KB)으로 나누어지고
- 물리 메모리 역시 같은 크기의 프레임(Frame)으로 나뉜다.
- 페이지 테이블(Page Table)은 각 가상 페이지가 어떤 물리 메모리에 매핑되는지를 관리한다.

이때 프로세스는 실행되는 동안 필요한 페이지만 먼저 메모리에 올리는데, 이를 `요구 페이징(Demand Paging)`이라고 한다.

#### 페이지 폴트(Page Fault)

페이지 폴트는 접근하려는 페이지가 아직 메모리에 없을 때 발생하는 예외이다.
CPU는 가상 주소를 페이지 테이블을 통해 변환하지만, 해당 항목이 존재하지 않거나 invalid 상태라면 페이지 폴트 인터럽트가 발생한다.

1. CPU가 접근한 가상 주소를 페이지 테이블에서 접근하다가 해당 페이지가 없으면 페이지 폴트 발생
2. 운영체제는 디스크의 스왑 영역에서 해당 페이지를 읽어옴
3. 만약 빈 프레임이 있다면 그곳에 페이지를 적재하고 페이지 테이블을 갱신
4. 아니라면 페이지 교체 알고리즘에 따라 기존 페이지를 내보내고 새로운 페이지를 적재(페이지 교체)하고 페이지 테이블을 갱신
5. 프로세스가 다시 재개됨

위의 과정은 매우 느리며, CPU가 페이지 폴트를 처리하는 동안 다른 작업을 수행하지 못한다.
즉, 페이지 폴트가 자주 발생하면 시스템 전체 성능이 크게 저하될 수 있다.

### 3. 멀티프로그래밍 정도가 높아질수록 Thrashing 발생 확률이 높아지는 이유

![thrashing_multi_programming.png](assets/thrashing_multi_programming.png)

멀티프로그래밍 정도란 한 시스템에서 동시에 실행되는 프로세스의 수를 의미한다.
운영체제는 CPU 활용도를 높이기 위해 여러 프로세스를 동시에 실행하지만, 물리 메모리는 한정적이다.
따라서 프로세스 수가 늘어날수록 각 프로세스에 할당되는 프레임 수는 줄어든다.

또, 각 프로세스가 원활히 실행되기 위한 Working Set(작업 집합)을 유지할 수 없게 된다.
메모리가 부족하면 Working Set를 메모리에 유지하지 못하고 필요할 때마다 디스크에서 불러오게 된다.
따라서, Page Fault가 폭증하고 프로세스들은 서로의 페이지를 계속 밀어내며 디스크 접근만 반복하는 Thrashing이 발생한다.

### 4. Thrashing을 해결하려면?

Thrashing을 방지하기 위해 운영체제는 다음과 같은 기법을 사용한다.

#### 작업 집합 모델 (Working Set Model)

Working Set(작업 집한)은 프로세스가 일정 시간 동안 자주 참조한 페이지들의 집합을 의미한다.

운영체제는 각 프로세스의 Working Set를 추적해서 충분한 프레임을 할당하려고 한다.
따라서, 프로세스가 필요로 하는 페이지들을 메모리에 유지하여 페이지 폴트의 빈도 수를 줄인다.

만약 메모리가 부족해서 Working Set를 모두 유지할 수 없다면, 운영체제는 일부 프로세스를 Swap Out(메모리에서 내보냄)한다.
그렇게 나머지 프로세스의 Working Set를 메모리에 유지하여 Thrashing을 방지한다.

#### Page Fault Frequency (PFF) 제어

운영체제는 각 프로세스의 페이지 부재율(Page Fault Frequency)를 지속적으로 감시한다.

부재율이 높을 때는 해당 프로세스에 더 많은 프레임을 할당하며
부재율이 낮을 때는 남는 프레임을 회수해 다른 프로세스에 배분한다.

위 방식을 통해 각 프로세스가 안정적으로 실행될 수 있도록 동적 프레임 조절을 수행한다.

#### 프로세스 수 조절 (Load Control)

Thrashing은 많은 프로세스로 인해 메모리 경쟁이 심할 때 발생하므로, 운영체제는 전체 시스템의 멀티프로그래밍 정도를 조절한다.

앞서 말한 Working Set의 내용과도 이어지는데, 동시에 실행되는 프로세스 수를 줄여 충분한 Working Set를 확보하도록 한다.
필요 시 일부 프로세스를 Swap Out하여 CPU와 메모리 자원을 확보한다.

#### 페이지 교체 알고리즘

자주 사용되는 페이지를 메모리에 유지하여 페이지 폴트를 줄이기 위해 LRU(Least Recently Used)와 같은 페이지 교체 알고리즘을 사용하기도 한다.
LRU 페이지 교체 알고리즘은 가장 오랫동안 참조되지 않은 페이지를 교체 대상으로 선택하여, 자주 사용되는 페이지가 메모리에 남도록 한다.
즉, 최근에 사용된 페이지는 앞으로도 곧 다시 사용될 가능성이 높다는 참조의 지역성(Locality of Reference) 원리를 기반으로 한다.

하지만 LRU 알고리즘을 구현하려면 운영체제가 모든 페이지 접근을 실시간으로 추적해야 하기 때문에 그만큼의 오버헤드가 발생한다.
따라서, 실제 운영체제에서는 LRU를 근사화하거나 개선한 WS Clock, ARC 등의 알고리즘이 많이 쓰인다.
