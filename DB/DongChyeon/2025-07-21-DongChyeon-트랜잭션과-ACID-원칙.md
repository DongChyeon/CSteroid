---
date: 2025-07-21
user: DongChyeon
topic: íŠ¸ëœì­ì…˜ê³¼ ACID ì›ì¹™
---

## 1. íŠ¸ëœì­ì…˜(Transaction)ì´ë€?

íŠ¸ëœì­ì…˜ì´ë€ ë°ì´í„°ë² ì´ìŠ¤ì˜ ìƒíƒœë¥¼ ë³€í™˜ì‹œí‚¤ëŠ” ì‘ì—…ì˜ ë…¼ë¦¬ì ì¸ ë‹¨ìœ„ë¥¼ ì˜ë¯¸í•œë‹¤. ì¦‰, ì—¬ëŸ¬ ì¿¼ë¦¬ë“¤ì„ í•˜ë‚˜ì˜ ì‘ì—… ë‹¨ìœ„ë¡œ ë¬¶ì–´, ëª¨ë‘ ì„±ê³µí•˜ê±°ë‚˜ ëª¨ë‘ ì‹¤íŒ¨í•˜ê²Œ ë§Œë“¤ì–´ ë°ì´í„°ì˜ ë¬´ê²°ì„±ì„ ë³´ì¥í•œë‹¤.

ë°ì´í„°ë² ì´ìŠ¤ íŠ¸ëœì­ì…˜ì€ ACID ì›ì¹™ì„ ë”°ë¥´ë©°, ì´ëŠ” íŠ¸ëœì­ì…˜ì˜ ì‹ ë¢°ì„±ê³¼ ì¼ê´€ì„±ì„ ë³´ì¥í•˜ëŠ” ë° ì¤‘ìš”í•œ ì—­í• ì„ í•œë‹¤.

## 2. ACID ì›ì¹™ì´ë€?

| ì›ì¹™ | ì˜ë¯¸ | ì„¤ëª… | ì˜ˆì‹œ |
|------|------|------|------|
| A - Atomicity (ì›ìì„±) | íŠ¸ëœì­ì…˜ì€ ëª¨ë‘ ìˆ˜í–‰ë˜ê±°ë‚˜, ì „í˜€ ìˆ˜í–‰ë˜ì§€ ì•Šì•„ì•¼ í•¨ | ì¤‘ê°„ì— ì‹¤íŒ¨í•˜ë©´ ì „ì²´ ì‘ì—…ì„ ë¡¤ë°±í•˜ì—¬ ì´ì „ ìƒíƒœë¡œ ë˜ëŒë¦¼ | A â†’ B ì†¡ê¸ˆ ì‹œ, A ê³„ì¢Œì—ì„œ ì¶œê¸ˆë˜ì—ˆì§€ë§Œ Bì— ì…ê¸ˆ ì‹¤íŒ¨í•˜ë©´ ì „ì²´ ì·¨ì†Œë˜ì–´ì•¼ í•¨ |
| C - Consistency (ì¼ê´€ì„±) | íŠ¸ëœì­ì…˜ ì „í›„ë¡œ DBì˜ ì œì•½ì¡°ê±´ê³¼ ê·œì¹™ì´ í•­ìƒ ë§Œì¡±ë˜ì–´ì•¼ í•¨ | ë¬´ê²°ì„± ì œì•½ì¡°ê±´(ê¸°ë³¸í‚¤, ì™¸ë˜í‚¤ ë“±)ì´ í•­ìƒ ìœ ì§€ë˜ì–´ì•¼ í•¨ | A ê³„ì¢Œ ì”ê³ ê°€ ìŒìˆ˜ê°€ ë˜ì§€ ì•Šë„ë¡ ì œì•½ì¡°ê±´ ì„¤ì •, ì´ë¥¼ ìœ„ë°˜í•˜ë©´ íŠ¸ëœì­ì…˜ ê±°ë¶€ |
| I - Isolation (ê²©ë¦¬ì„±) | ë™ì‹œì— ì‹¤í–‰ë˜ëŠ” íŠ¸ëœì­ì…˜ì´ ì„œë¡œ ì˜í–¥ì„ ì£¼ì§€ ì•Šì•„ì•¼ í•¨ | íŠ¸ëœì­ì…˜ ê°„ ê°„ì„­ ë°©ì§€, ê²©ë¦¬ ìˆ˜ì¤€ ì„¤ì •ìœ¼ë¡œ ë™ì‹œì„± ì¡°ì ˆ | ë‘ ëª…ì´ ë™ì‹œì— ê°™ì€ ì¬ê³  ìƒí’ˆ êµ¬ë§¤ ì‹œ, ì´ˆê³¼ íŒë§¤ë˜ì§€ ì•Šë„ë¡ ì²˜ë¦¬ í•„ìš” |
| D - Durability (ì§€ì†ì„±) | íŠ¸ëœì­ì…˜ì´ ì»¤ë°‹ë˜ë©´ ê²°ê³¼ëŠ” ì˜êµ¬ ì €ì¥ë˜ì–´ì•¼ í•¨ | ì¥ì•  ë°œìƒ ì‹œì—ë„ ë³€ê²½ ë‚´ìš©ì€ ì†ì‹¤ë˜ì§€ ì•ŠìŒ | ì „ì› ì¥ì•  í›„ì—ë„ B ê³„ì¢Œì— ì…ê¸ˆëœ ë°ì´í„°ëŠ” ìœ ì§€ë˜ì–´ì•¼ í•¨ (ë¡œê·¸/ì €ë„ í™œìš©) |

## 3. Isolation Level (ê²©ë¦¬ ìˆ˜ì¤€)

| ìˆ˜ì¤€ | ì„¤ëª… | ë°œìƒ ê°€ëŠ¥í•œ ë¬¸ì œ | ì„±ëŠ¥ |
|------|------|------------------|------|
| READ UNCOMMITTED | ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì˜ ë¯¸ì™„ë£Œ ë°ì´í„°ë¥¼ ì½ì„ ìˆ˜ ìˆìŒ | Dirty Read | ê°€ì¥ ë¹ ë¦„ |
| READ COMMITTED | ì»¤ë°‹ëœ ë°ì´í„°ë§Œ ì½ìŒ | Non-Repeatable Read | ë¹ ë¦„ |
| REPEATABLE READ | íŠ¸ëœì­ì…˜ ë‚´ ë™ì¼ ì¿¼ë¦¬ëŠ” í•­ìƒ ë™ì¼í•œ ê²°ê³¼ ë°˜í™˜ | Phantom Read | ì¤‘ê°„ |
| SERIALIZABLE | íŠ¸ëœì­ì…˜ì„ ìˆœì°¨ì ìœ¼ë¡œ ì‹¤í–‰í•œ ê²ƒì²˜ëŸ¼ ì²˜ë¦¬ | ì—†ìŒ (ê°€ì¥ ì—„ê²©) | ê°€ì¥ ëŠë¦¼ |

> ğŸ’¡ ì°¸ê³ : ëŒ€ë¶€ë¶„ì˜ RDBMSëŠ” ê¸°ë³¸ì ìœ¼ë¡œ `READ COMMITTED` ë˜ëŠ” `REPEATABLE READ`ë¥¼ ì‚¬ìš©

1. Dirty Read
    - ë°œìƒ ì¡°ê±´: ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì´ ì•„ì§ ì»¤ë°‹ë˜ì§€ ì•Šì€ ë°ì´í„°ë¥¼ ì½ëŠ” ê²½ìš°
    - ì„¤ëª…: íŠ¸ëœì­ì…˜ ê°„ ì„ì‹œ ë³€ê²½ ë°ì´í„°ë¥¼ ì½ìŒ
    - ì‹œë‚˜ë¦¬ì˜¤: íŠ¸ëœì­ì…˜ Aê°€ ê¸ˆì•¡ì„ 200ìœ¼ë¡œ ë°”ê¾¸ê³  ì•„ì§ ì»¤ë°‹ì„ í•˜ì§€ ì•Šì•˜ì§€ë§Œ, íŠ¸ëœì­ì…˜ Bê°€ í•´ë‹¹ ê°’ì„ ì½ìŒ
2. Non-Repeatable Read
    - ë°œìƒ ì¡°ê±´: ê°™ì€ ì¿¼ë¦¬ë¥¼ ë‘ ë²ˆ ì‹¤í–‰í–ˆëŠ”ë°, ë‹¤ë¥¸ ê²°ê³¼ê°€ ë‚˜ì˜´
    - ì„¤ëª…: ì¤‘ê°„ì— ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì´ ìˆ˜ì •/ì»¤ë°‹í•´ì„œ ê°’ì´ ë°”ë€œ
    - ì‹œë‚˜ë¦¬ì˜¤: íŠ¸ëœì­ì…˜ Aê°€ 100ì› ì¡°íšŒ í›„, íŠ¸ëœì­ì…˜ Bê°€ 200ì›ìœ¼ë¡œ ì—…ë°ì´íŠ¸í•˜ê³  ì»¤ë°‹í•¨. ë‹¤ì‹œ íŠ¸ëœì­ì…˜ Aê°€ ì¡°íšŒí•˜ë©´ 200ì›ì´ ë‚˜ì˜´.
3. Phantom Read
    - ë°œìƒ ì¡°ê±´: ê°™ì€ ì¡°ê±´ì˜ SELECTì¸ë° ë ˆì½”ë“œ ê°œìˆ˜ê°€ ë‹¬ë¼ì§
    - ì„¤ëª…: ì¤‘ê°„ì— ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì´ insert/deleteí•´ì„œ í–‰ì´ ì¶”ê°€ë¨
    - ì‹œë‚˜ë¦¬ì˜¤: íŠ¸ëœì­ì…˜ Aê°€ íŠ¹ì • ì¡°ê±´ìœ¼ë¡œ 10ê°œì˜ í–‰ì„ ì¡°íšŒí–ˆëŠ”ë°, íŠ¸ëœì­ì…˜ Bê°€ ìƒˆë¡œìš´ í–‰ì„ ì¶”ê°€í•´ì„œ ë‹¤ìŒ ì¡°íšŒ ì‹œ 11ê°œê°€ ë‚˜ì˜´.

## 4. íŠ¸ëœì­ì…˜ ì‹¤íŒ¨ ì‹œ ì‹œë‚˜ë¦¬ì˜¤

1. ì‹œë„ ì‘ì—…:
    - ìƒí’ˆ ì¬ê³  ì°¨ê°
    - ê²°ì œ í…Œì´ë¸”ì— ê²°ì œ ë‚´ì—­ ì €ì¥
    - í¬ì¸íŠ¸ ì°¨ê°
    - ì£¼ë¬¸ ì™„ë£Œ ì²˜ë¦¬

2. ì¤‘ê°„ ì‹¤íŒ¨: í¬ì¸íŠ¸ ì°¨ê° ì¤‘ DB ì˜¤ë¥˜ ë°œìƒ

3. Rollback ìˆ˜í–‰:
    - ì¬ê³  ì°¨ê° â†’ ë³µêµ¬
    - ê²°ì œ ë‚´ì—­ â†’ ì‚­ì œ
    - í¬ì¸íŠ¸ â†’ ì›ë˜ëŒ€ë¡œ ë³µêµ¬
    - ì£¼ë¬¸ ìƒíƒœ â†’ ì·¨ì†Œ

4. ì‚¬ìš©ì ì…ì¥:
    - "ê²°ì œ ì‹¤íŒ¨" ë©”ì‹œì§€ ë…¸ì¶œ
    - ëª¨ë“  ìƒíƒœëŠ” íŠ¸ëœì­ì…˜ ì´ì „ìœ¼ë¡œ ë˜ëŒì•„ê° (ì›ìì„± ë³´ì¥)

## 5. íŠ¸ëœì­ì…˜ ì‚¬ìš© ì˜ˆì‹œ (ì½”ë“œ)

```kotlin
internal object DatabaseMigrations {

    val MIGRATION_1_2 = object : Migration(1, 2) {
        override fun migrate(database: SupportSQLiteDatabase) {
            database.beginTransaction()
            try {
                // 1. ìƒˆ ìŠ¤í‚¤ë§ˆë¡œ ì„ì‹œ í…Œì´ë¸” ìƒì„± (isAm ì»¬ëŸ¼ ì œì™¸, missionType, missionCount ì¶”ê°€ ë° ê¸°ë³¸ê°’ ë³€ê²½)
                database.execSQL(
                    """
                CREATE TABLE ${DATABASE_NAME}_new (
                    id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,
                    hour INTEGER NOT NULL,
                    minute INTEGER NOT NULL,
                    second INTEGER NOT NULL,
                    repeatDays INTEGER NOT NULL,
                    isHolidayAlarmOff INTEGER NOT NULL,
                    isSnoozeEnabled INTEGER NOT NULL,
                    snoozeInterval INTEGER NOT NULL,
                    snoozeCount INTEGER NOT NULL,
                    isVibrationEnabled INTEGER NOT NULL,
                    isSoundEnabled INTEGER NOT NULL,
                    soundUri TEXT NOT NULL,
                    soundVolume INTEGER NOT NULL,
                    isAlarmActive INTEGER NOT NULL,
                    missionType INTEGER NOT NULL DEFAULT 1,  -- íƒ€ì… INTEGER, ê¸°ë³¸ê°’ 1
                    missionCount INTEGER NOT NULL DEFAULT 10 -- íƒ€ì… INTEGER, ê¸°ë³¸ê°’ 10
                )
                    """.trimIndent(),
                )

                // 2. ê¸°ì¡´ í…Œì´ë¸”ì—ì„œ ìƒˆ ì„ì‹œ í…Œì´ë¸”ë¡œ ë°ì´í„° ë³µì‚¬ (isAm ì»¬ëŸ¼ì€ ë³µì‚¬í•˜ì§€ ì•ŠìŒ)
                database.execSQL(
                    """
                INSERT INTO ${DATABASE_NAME}_new (
                    id, hour, minute, second, repeatDays, isHolidayAlarmOff,
                    isSnoozeEnabled, snoozeInterval, snoozeCount, isVibrationEnabled,
                    isSoundEnabled, soundUri, soundVolume, isAlarmActive
                    -- missionType, missionCountëŠ” CREATE TABLEì—ì„œ ì •ì˜ëœ ê¸°ë³¸ê°’ìœ¼ë¡œ ìë™ ì±„ì›Œì§
                )
                SELECT
                    id,
                    -- hourë¥¼ 24ì‹œê°„ í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.
                    -- ì˜ˆì‹œ: isAm ì»¬ëŸ¼ì´ 0 (PM)ì´ê³  hourê°€ 12ê°€ ì•„ë‹ˆë©´ hour + 12
                    -- ì˜ˆì‹œ: isAm ì»¬ëŸ¼ì´ 1 (AM)ì´ê³  hourê°€ 12 (ìì •)ì´ë©´ 0ìœ¼ë¡œ ë³€í™˜
                    -- ì‹¤ì œ isAm ì»¬ëŸ¼ì˜ ì˜ë¯¸ì™€ ê°’ì— ë”°ë¼ ì•„ë˜ ë¡œì§ì„ ì¡°ì •í•´ì•¼ í•©ë‹ˆë‹¤.
                    CASE
                        WHEN isAm = 0 AND hour != 12 THEN hour + 12 -- ì˜¤í›„ 1ì‹œ ~ 11ì‹œ -> 13 ~ 23ì‹œ
                        WHEN isAm = 1 AND hour = 12 THEN 0          -- ì˜¤ì „ 12ì‹œ (ìì •) -> 0ì‹œ
                        ELSE hour                                   -- ê·¸ ì™¸ (ì˜¤ì „ 1ì‹œ ~ 11ì‹œ, ì˜¤í›„ 12ì‹œ(ì •ì˜¤))
                    END AS hour_24,
                    minute,
                    second,
                    repeatDays,
                    isHolidayAlarmOff,
                    isSnoozeEnabled,
                    snoozeInterval,
                    snoozeCount,
                    isVibrationEnabled,
                    isSoundEnabled,
                    soundUri,
                    soundVolume,
                    isAlarmActive
                FROM $DATABASE_NAME
                    """.trimIndent(),
                )

                // 3. ê¸°ì¡´ í…Œì´ë¸” ì‚­ì œ
                database.execSQL("DROP TABLE $DATABASE_NAME")

                // 4. ì„ì‹œ í…Œì´ë¸”ì˜ ì´ë¦„ì„ ê¸°ì¡´ í…Œì´ë¸” ì´ë¦„ìœ¼ë¡œ ë³€ê²½
                database.execSQL("ALTER TABLE ${DATABASE_NAME}_new RENAME TO $DATABASE_NAME")

                // 5. ì»¤ë°‹
                database.setTransactionSuccessful()
            } finally {
                database.endTransaction()
            }
        }
    }
}
```

ì•ˆë“œë¡œì´ë“œ ì•± ê°œë°œ ë‹¹ì‹œ ë²„ì „ ì—…ë°ì´íŠ¸ì— ë”°ë¼ ê¸°ì¡´ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆë¥¼ ë³€ê²½í•´ì•¼ í–ˆë˜ ìƒí™©ì´ë‹¤.
ì´ë•Œ, íŠ¸ëœì­ì…˜ì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ë³€ê²½ ì‘ì—…ì„ ì•ˆì „í•˜ê²Œ ìˆ˜í–‰í–ˆë‹¤.